name: Get Last Modified File

on:
  pull_request:
    branches:
      - main

permissions:
  contents: read       # Permette di leggere il codice del repository
  pull-requests: read  # Permette di leggere le informazioni della pull request

jobs:
  get-last-modified-file:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout the code
      uses: actions/checkout@v3

    - name: Get the last modified file
      run: |
        git fetch origin +refs/pull/${{ github.event.pull_request.number }}/merge
        changed_files=$(git diff --name-only origin/main...HEAD)
        last_modified_file=$(echo "$changed_files" | tail -n 1)
        echo "Last modified file or folder: $last_modified_file"
        echo "last_modified_file=$last_modified_file" >> $GITHUB_ENV

    - name: Use last modified file output
      run: |
        echo "The last modified file is: ${{ env.last_modified_file }}"
